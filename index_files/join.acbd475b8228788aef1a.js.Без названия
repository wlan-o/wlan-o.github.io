/*! For license information please see join.acbd475b8228788aef1a.js.LICENSE.txt */
(()=>{"use strict";var e,t,n,o={988882:(e,t,n)=>{function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.d(t,{Config:()=>J,Connect:()=>ge,Messenger:()=>ye});var i=["agreements","promo","vkc_behavior","vkc_auth_action","vkc_brand","vkc_display_mode","service_groups","external_device_id"],r=!("undefined"==typeof window||!window.document||!window.document.createElement),a=r&&!!window.addEventListener;function s(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function c(e,t){return e(t={exports:{}},t.exports),t.exports}var l=s(c((function(e){function t(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=t=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),t(n)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}))),u=function(){};if(a)try{var d=Object.defineProperty({},"passive",{get:function(){}});window.addEventListener("test",u,d),window.removeEventListener("test",u,d)}catch(o){}!function(){if(!r)return!1;try{document.createElement("div").scrollTo({top:0,get behavior(){return!0,"smooth"}})}catch(e){}}();var p=c((function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o},e.exports.default=e.exports,e.exports.__esModule=!0}));s(p);var h=c((function(e){e.exports=function(e){if(Array.isArray(e))return p(e)},e.exports.default=e.exports,e.exports.__esModule=!0}));s(h);var _=c((function(e){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.default=e.exports,e.exports.__esModule=!0}));s(_);var g=c((function(e){e.exports=function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0}));s(g);var m=c((function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0}));s(m),s(c((function(e){e.exports=function(e){return h(e)||_(e)||g(e)||m()},e.exports.default=e.exports,e.exports.__esModule=!0})));var f=s(c((function(e){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.default=e.exports,e.exports.__esModule=!0})));function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"!==l(e)||null===e)return"";t=E({encode:!0},t);var n=function(e){return t.encode?encodeURIComponent(e):String(e)};return Object.keys(e).reduce((function(o,i){var r=e[i];return void 0===r?o:null===r?(t.skipNull||o.push([n(i),""].join("=")),o):Array.isArray(r)?(r.map((function(e){o.push("".concat(n(i),"[]=").concat(n(e)))})).join(),o):(o.push([n(i),n(r)].join("=")),o)}),[]).join("&")};function y(e){return S(e)}function I(e){return Object.keys(e).filter((function(e){return i.includes(e)}))}function T(e){var t;return Boolean(null===(t=I(e))||void 0===t?void 0:t.length)}function R(e){var t=function(e){return I(e).reduce((function(t,n){return t[n]=e[n],t}),{})}(e);return btoa(JSON.stringify(t))}function A(e,t){var n,o,i=document.createElement("iframe");for(var r in e&&(i.src=e),i.style.cssText=null!==(n=null==t?void 0:t.cssText)&&void 0!==n?n:"",i.width="100%",i.height="100%",i.style.border="none",null==t?void 0:t.properties)t&&t.properties.hasOwnProperty(r)&&(i[r]=null!==(o=t.properties[r])&&void 0!==o?o:"");return i}function O(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=function(e){return e&&"object"===o(e)};return e.reduce((function(e,t){return Object.keys(t).forEach((function(o){var i=e[o],r=t[o];Array.isArray(i)&&Array.isArray(r)?e[o]=i.concat.apply(i,r):n(i)&&n(r)?e[o]=O(i,r):e[o]=r})),e}),{})}function C(e,t){return void 0===e?t:"number"!=typeof e?e?1:0:e}function P(e,t){return e&&"object"===o(e)?Object.keys(e).reduce((function(n,o){return t.includes(o)?(n[o]=e[o],n):n}),{}):e}s(c((function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0}))),s(c((function(e){function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}e.exports=function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e},e.exports.default=e.exports,e.exports.__esModule=!0})));var w,b,N,D=new(function(){function e(){this.savedStyles=[],this.bodyScrollYValue=0,this.isFreezed=!1}return e.prototype.freezeBodyOverflow=function(){if(!this.isFreezed){this.isFreezed=!0;var e=(n=window.document.documentElement.clientWidth,Math.abs(window.innerWidth-n)),t=parseInt(window.getComputedStyle(window.document.body).paddingRight,10)||0;this.bodyScrollYValue=window.pageYOffset||window.scrollY,this.savedStyles=[],this.savedStyles.push({value:window.document.body.style.paddingRight,property:"padding-right"},{value:window.document.body.style.overflow,property:"overflow"},{value:window.document.body.style.overflowX,property:"overflow-x"},{value:window.document.body.style.overflowY,property:"overflow-y"}),window.document.body.style.setProperty("overflow","hidden"),window.document.body.style.setProperty("padding-right",e+t+"px")}var n},e.prototype.restoreBodyOverflow=function(){this.isFreezed&&(this.savedStyles.forEach((function(e){var t=e.value,n=e.property;t?window.document.body.style.setProperty(n,t):window.document.body.style.removeProperty(n)})),window.scrollTo(0,this.bodyScrollYValue),this.isFreezed=!1)},e}());!function(e){e.OPEN="VKSDKOpen",e.CLOSE="VKSDKClose",e.LOGOUT="VKSDKLogout",e.GET_CAPTCHA="VKSDKGetCaptcha",e.AUTH_NEEDED="VKSDKAuthNeeded",e.UPDATE_PARAMS="VKSDKUpdateParams",e.REQUEST_SUPERAPP_TOKEN="VKSDKRequestSuperAppToken",e.ERROR="VKSDKError"}(w||(w={})),function(e){e.INIT="VKSDKInit"}(b||(b={})),function(e){e[e.UNKNOWN=1]="UNKNOWN",e[e.MISSING_PARAM=2]="MISSING_PARAM",e[e.CONNECTION_LOST=3]="CONNECTION_LOST",e[e.USER_DENIED=4]="USER_DENIED",e[e.INVALID_PARAMS=5]="INVALID_PARAMS",e[e.CUSTOM=6]="CUSTOM",e[e.LOADING_ERROR=7]="LOADING_ERROR",e[e.CONNECT_WINDOW_CLOSED=7]="CONNECT_WINDOW_CLOSED",e[e.CONNECT_WINDOW_NOT_OPENED=8]="CONNECT_WINDOW_NOT_OPENED",e[e.CONNECT_DOMAIN_NOT_ALLOWED=9]="CONNECT_DOMAIN_NOT_ALLOWED",e[e.CONNECT_UNKNOWN_SDK_MESSAGE=10]="CONNECT_UNKNOWN_SDK_MESSAGE",e[e.CONNECT_CLIENT_SDK_ERROR=11]="CONNECT_CLIENT_SDK_ERROR",e[e.OLD_MISSING_PARAM=100]="OLD_MISSING_PARAM"}(N||(N={}));var j,k,L,x,F=function(e,t){return'Wrong "'+e+'" param. '+(t||"")},M=function(e){return'URL domain "'+e+'" is not allowed.'},U=function(e){return"This SDK message is unknown: "+e},K=function(e){return e.error+";"+e.errorCode},H=function(e,t){return(H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},B=function(){return(B=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function V(e){return e=e||Object.create(null),{on:function(t,n){(e[t]||(e[t]=[])).push(n)},off:function(t,n){e[t]&&e[t].splice(e[t].indexOf(n)>>>0,1)},emit:function(t,n){(e[t]||[]).slice().map((function(e){e(n)})),(e["*"]||[]).slice().map((function(e){e(t,n)}))}}}!function(e){e.APP_CLOSE="VKWebAppClose",e.APP_READY="VKSDKMiniAppReady",e.RESIZE="VKSDKMiniAppResize",e.APP_INIT_CONFIG="VKSDKMiniAppInitConfig",e.OPEN_APP="VKWebAppOpenApp",e.OPEN_PAY_FORM="VKWebAppOpenPayForm",e.ACTION_DONE="VKWebAppActionDone",e.SET_TITLE="VKWebAppSetTitle",e.AUTH_BY_EXCHANGE_TOKEN="VKWebAppAuthByExchangeToken",e.FORCE_LOGOUT="VKWebAppForceLogout"}(j||(j={})),function(e){e.OPEN="open",e.HIDE="hide",e.CLOSE="close",e.SHOW="show",e.MESSAGE="message",e.CREATE_APP="createapp"}(k||(k={})),function(e){e.SUPERAPP_TOKEN="VKSDKGeneralSuperAppToken",e.AUTH_NEEDED="VKSDKGeneralAuthNeeded",e.OPEN_APP="VKSDKGeneralOpenApp"}(L||(L={})),function(e){e.SUPERAPP_TOKEN_CHANGE_V2="superAppTokenV2",e.SUPERAPP_TOKEN_CHANGE="superAppToken"}(x||(x={}));var G,Y={appId:0,superAppToken:"",superAppTokenV2:"",loginDomain:"login.vk.com",oauthDomain:"oauth.vk.com",connectDomain:"id.vk.com",_debug:!1,_localhost:!1},W={},J=function(){function e(){}return e.init=function(e){if(!e.appId)throw new Error("appId required");Y.appId=e.appId,Y.superAppToken=e.superAppToken||"",Y.superAppTokenV2=e.superAppTokenV2||"",Y.loginDomain=e.loginDomain||"login.vk.com",Y.oauthDomain=e.oauthDomain||"oauth.vk.com",Y.connectDomain=e.connectDomain||"id.vk.com",Y.appSettings=e.appSettings,Y._debug=!!e._debug,Y._localhost=!!e._localhost},e.get=function(){return Y},e.setSuperAppToken=function(t,n){void 0===n&&(n={}),2===n.version?(Y.superAppTokenV2=t,e.events.emit(x.SUPERAPP_TOKEN_CHANGE_V2,t)):(Y.superAppToken=t,e.events.emit(x.SUPERAPP_TOKEN_CHANGE,t))},e.onRequestSuperAppToken=function(e){W.requestSuperAppToken=e},e._requestSuperAppToken=function(t,n){var o;void 0===n&&(n={}),W.requestSuperAppToken&&(o=W.requestSuperAppToken(t,n)),o&&o.then((function(t){return e.setSuperAppToken(t,n)})).catch(console.error)},e.onAuth=function(e){W.auth=e},e._auth=function(t){var n;void 0===t&&(t={}),W.auth&&(n=W.auth()),n&&n.then((function(n){e.setSuperAppToken(n,t)})).catch(console.error)},e.onOpenApp=function(e){W.openApp=e},e._openApp=function(e){W.openApp&&W.openApp(e.app)},e.onLogout=function(e){W.logout=e},e._logout=function(){W.logout&&W.logout()},e.events=V(),e}(),z=function(e){var t=this;this.handler=function(){return{}},this.destroy=function(){delete t.config,window.removeEventListener("message",t.handleMessage)},this.onMessage=function(e){t.handler=e},this.sendMessage=function(e){var n;null===(n=t.config.iframe.contentWindow)||void 0===n||n.postMessage(B({type:"vk-sak-sdk"},e),t.config.origin)},this.handleMessage=function(e){t.config.origin&&e.origin===t.config.origin&&e.source===t.config.iframe.contentWindow&&e.data&&"vk-sak-sdk"===e.data.type&&t.handler(e.data)},this.config=e,window.addEventListener("message",this.handleMessage)},q=function e(t){var n=this;this.readyPromiseResolve=null,this.readyPromise=null,this.child=null,this.initialTitle=window.document.title,this.open=function(e,t){return n.loading?(n.iframe.src=n.getMiniAppUrl(e,t),n.loading=new Promise((function(e){n.iframe.onload=function(){n.iframe.onload=null,e()}})),n.readyPromise=new Promise((function(e){return n.readyPromiseResolve=e}))):n.preload(e,t).catch(console.error),n.iframe.style.display="block",n.params.stackMode||D.freezeBodyOverflow(),n.loading.then(n.handleResize).catch(console.error),n.events.emit(k.OPEN),n.readyPromise},this.hide=function(){n.iframe.style.display="none",n.params.stackMode||D.restoreBodyOverflow(),n.events.emit(k.HIDE)},this.close=function(e){window.document.title!==n.initialTitle&&(window.document.title=n.initialTitle),n.params.stackMode||D.restoreBodyOverflow(),n.iframe&&n.iframe.remove(),n.bridge&&n.bridge.destroy(),delete n.iframe,delete n.bridge,J.events.off(x.SUPERAPP_TOKEN_CHANGE,n.onSuperAppToken),window.removeEventListener("resize",n.handleResize),n.events.emit(k.CLOSE,e)},this.show=function(){if(!n.loading)throw new Error('App is not loaded, use "open" or "preload" methods');n.iframe.style.display="block",n.params.stackMode||D.freezeBodyOverflow(),n.events.emit(k.SHOW)},this.preload=function(e,t){var o=document.createElement("iframe"),i=window.innerHeight,r=isFinite(n.params.zIndex)?n.params.zIndex:999999;return o.src=n.getMiniAppUrl(e,t),o.setAttribute("allow","geolocation"),o.style.cssText="\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: "+i+"px;\n      min-height: "+i+"px;\n      border: none;\n      z-index: "+r+";\n    ",n.iframe=o,document.body.appendChild(n.iframe),n.bridge=new z({iframe:n.iframe,origin:"https://"+J.get().connectDomain}),n.loading=new Promise((function(e){o.onload=function(){o.onload=null,e()}})),n.readyPromise=new Promise((function(e){return n.readyPromiseResolve=e})),n.bridge.onMessage(n.handleMessage),J.events.on(x.SUPERAPP_TOKEN_CHANGE,n.onSuperAppToken),window.addEventListener("resize",n.handleResize),n.loading},this.sendMessage=function(e){n.bridge.sendMessage(e)},this.onSuperAppToken=function(e){n.bridge.sendMessage({handler:L.SUPERAPP_TOKEN,params:{result:e}})},this.handleMessage=function(e){switch(e.handler){case j.APP_CLOSE:n.hide();break;case j.APP_READY:n.resolveReadyPromise(),n.handleUpdateConfig();break;case j.OPEN_APP:n.openMiniapp(e.params);break;case j.OPEN_PAY_FORM:n.openPayForm(e.params);break;case j.SET_TITLE:n.setTitle(e.params);break;case j.AUTH_BY_EXCHANGE_TOKEN:n.onAuthByExchangeToken();break;case j.FORCE_LOGOUT:n.onForceLogout();break;case L.SUPERAPP_TOKEN:J._requestSuperAppToken(e.params);break;case L.AUTH_NEEDED:J._auth();break;default:n.events.emit(k.MESSAGE,e)}},this.handleResize=function(){if(n.iframe){var e=innerWidth,t=innerHeight;n.iframe.style.height=t+"px",n.iframe.style.minHeight=t+"px",n.bridge.sendMessage({handler:j.RESIZE,params:{viewport_width:e,viewport_height:t}})}},this.handleUpdateConfig=function(){n.bridge.sendMessage({handler:j.APP_INIT_CONFIG,params:{fullMode:n.params.fullMode,hideMenu:n.params.hideMenu}})},this.getMiniAppUrl=function(e,t){var o=J.get(),i=o.connectDomain,r=o.appId,a=o.superAppToken,s=o._debug;return"https://"+i+"/mini_app?"+y({app:n.params.app,host_app_id:r,debug:s?"1":"",localhost:s?"1":"",superapp_token:a,app_query:e?JSON.stringify(e):"",app_hash:t||""})},this.resolveReadyPromise=function(){n.readyPromise&&n.readyPromiseResolve&&(n.readyPromiseResolve(),n.readyPromise=null,n.readyPromiseResolve=null)},this.openMiniapp=function(t){n.child=new e({app:t.app_id,stackMode:n.params.stackMode}),n.events.emit(k.CREATE_APP,{app:n.child,location:t.location})},this.openPayForm=function(t){var o=B({},t.params);o.data&&(o.data=JSON.stringify(o.data));var i=B(B({},o),{app_id:t.app_id,action:t.action}),r=new e({app:6217559,stackMode:n.params.stackMode});r.open(i).then((function(){return n.hide()})).catch(console.error),r.events.on(k.MESSAGE,(function(e){n.handleVKPayFormMessage(e),r.close(),n.show()})),r.events.on(k.HIDE,(function(){r.close(),n.close()}))},this.setTitle=function(e){window.document.title=e.title},this.onAuthByExchangeToken=function(){n.close({closedByExchangeToken:!0})},this.onForceLogout=function(){n.close({closedByForceLogout:!0})},this.handleVKPayFormMessage=function(e){e.handler===j.ACTION_DONE&&n.sendMessage(e)},this.params=B(B({},t),{app:"number"==typeof t.app?"app"+t.app:t.app}),this.events=V()},Z=(function(){function e(){this.stack=[]}e.prototype.removeMiniApp=function(e){var t=e.app,n=this.stack.lastIndexOf(t);if(n>-1&&n===this.stack.length-1)if(this.stack.splice(n,1),this.stack.length){this.stack[this.stack.length-1].show();var o=this.stack[this.stack.length-2];setTimeout((function(){return null==o?void 0:o.hide()}),0)}else D.restoreBodyOverflow()},e.prototype.makeHandleMiniAppClose=function(e){var t=this,n=e.app;return function(){t.removeMiniApp({app:n})}},e.prototype.makeHandleMiniAppHide=function(e){var t=this,n=e.app;return function(){var e=t.stack.lastIndexOf(n);e>-1&&e===t.stack.length-1&&setTimeout((function(){return n.close()}),0)}},e.prototype.handleMiniAppCreate=function(e){var t=e.app,n=e.query,o=e.hash;this.stack.push(t),t.open(n,o).catch(console.error),t.events.on(k.CREATE_APP,this.handleMiniAppCreate.bind(this)),t.events.on(k.HIDE,this.makeHandleMiniAppHide({app:t})),t.events.on(k.CLOSE,this.makeHandleMiniAppClose({app:t})),D.freezeBodyOverflow();var i=this.stack[this.stack.length-2];return setTimeout((function(){null==i||i.hide()}),0),t},Object.defineProperty(e.prototype,"length",{get:function(){return this.stack.length},enumerable:!1,configurable:!0}),e.prototype.open=function(e){var t=e.app,n=e.query,o=e.hash,i=new q({app:t,stackMode:!0});return this.handleMiniAppCreate({app:i,query:n,hash:o}),i},e.prototype.close=function(){var e=this.stack;this.stack.splice(0),e.reverse().forEach((function(e){return e.close()})),D.restoreBodyOverflow()}}(),"ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"),$=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21,t="",n=e;n--;)t+=Z[64*Math.random()|0];return t};!function(e){e.STATIC_MAP="VKSDKRequestToGeoservice:staticmap/png/",e.SEARCH="VKSDKRequestToGeoservice:search",e.OVERALL="VKSDKRequestToGeoservice:overall",e.DIRECTIONS="VKSDKRequestToGeoservice:directions",e.ISO="VKSDKRequestToGeoservice:iso"}(G||(G={}));!function(){function e(e){var t=this;this.apiKey=e.apiKey;var n=document.createElement("iframe"),o=J.get().appId;n.src=this.getGeoserviceProxyUrl({app_id:o}),n.style.cssText="\n      display: none;\n    ",this.iframe=n,document.body.appendChild(this.iframe),this.bridge=new z({iframe:this.iframe,origin:"https://"+J.get().connectDomain}),this.requestMap={},this.bridge.onMessage((function(e){var n=e.params,o=n.requestID,i=n.response;t.requestMap[o].resolve(i),delete t.requestMap[o]}))}e.prototype.setApiKey=function(e){this.apiKey=e},e.prototype.getGeoserviceProxyUrl=function(e){var t=J.get(),n=t.connectDomain,o=t._debug;return"https://"+n+"/geoservice?"+y(B(B({},e||{}),{origin:location.protocol+"//"+location.host,localhost:String(location.host.includes("localhost")),debug:location.host.includes("localhost")?1:String(o)}))},e.prototype.prepareAnswer=function(e,t,n){var o=this,i=$();return this.bridge.sendMessage({handler:"VKSDKRequestToGeoservice:"+e,params:B(B({},t),{api_key:this.apiKey,wrapRequestInJSON:n,requestID:i})}),new Promise((function(e,t){o.requestMap[i]={resolve:e,reject:t}}))},e.prototype.getStaticMap=function(e){return this.prepareAnswer("staticmap/png/",e)},e.prototype.encodeCoords=function(e){return this.prepareAnswer("search",e)},e.prototype.decodeCoords=function(e){return this.prepareAnswer("overall",e)},e.prototype.getDirections=function(e){return this.prepareAnswer("directions",e,!0)},e.prototype.getISO=function(e){return this.prepareAnswer("iso",e,!0)}}();var Q=["extend_token","login_with_user","login_silent_user","__sferum_invite_link","registration_with_phone","registration_with_email","validate_phone","bind_ok_account"];function X(e){return e&&Q.includes(e.name)?btoa(JSON.stringify(e)):""}function ee(e,t){void 0===t&&(t="auth");var n=J.get(),o=n.appId,i=n.connectDomain,r=n.appSettings,a=B({app_id:o,response_type:"silent_token",v:"1.43.0"},e);return r&&T(r)&&(a.app_settings=R(r)),"https://"+i+"/"+t+"?"+y(a)}var te,ne=[0,1,3,4,6,15,16,82];!function(e){e.Default="default",e.NamePhone="name_phone",e.PhoneName="phone_name"}(te||(te={}));var oe,ie=[te.Default,te.NamePhone,te.PhoneName];!function(e){e.Primary="primary",e.Flat="flat"}(oe||(oe={}));var re,ae,se,ce,le,ue,de,pe=[oe.Primary,oe.Flat];!function(e){e.SHOW_DATA_POLICY="VKSDKOneTapAuthConnectDataPolicy",e.HIDE_DATA_POLICY="VKSDKOneTapAuthDataPolicyClose",e.DATA_POLICY_RESULT="VKSDKOneTapAuthDataPolicyResult",e.SHOW_CAPTCHA="VKSDKOneTapAuthDataPolicyShowCaptcha"}(re||(re={})),function(e){e.SHOW_POLICY_AGREEMENTS="VKSDKOneTapAuthPolicyAgreementsShow",e.HIDE_POLICY_AGREEMENTS="VKSDKOneTapAuthPolicyAgreementsHide",e.ACCEPT_POLICY_AGREEMENTS="VKSDKOneTapAuthPolicyAgreementsAccept",e.DECLINE_POLICY_AGREEMENTS="VKSDKOneTapAuthPolicyAgreementsDecline",e.POLICY_AGREEMENTS_ERROR="VKSDKOneTapAuthPolicyAgreementsError",e.SHOW_DATA_POLICY="VKSDKOneTapAuthPolicyAgreementsShowDataPolicy"}(ae||(ae={})),function(e){e.CAPTCHA_SUCCESS="VKSDKAuthCaptchaSuccess",e.CAPTCHA_FAIL="VKSDKAuthCaptchaFail"}(se||(se={})),function(e){e.PHONE_VALIDATION_NEEDED="VKSDKOneTapAuthPhoneValidationNeeded",e.FULL_AUTH_NEEDED="VKSDKOneTapAuthFullAuthNeeded",e.AUTH_DATA_LOADED="VKSDKOneTapAuthDataLoaded",e.NOT_AUTHORIZED="VKSDKOneTapAuthNotAuthorized",e.LOGIN_SUCCESS="VKSDKOneTapAuthLoginSuccess",e.RESIZE_FRAME="VKSDKOneTapResizeFrame",e.SHOW_CAPTCHA="VKSDKOneTapShowCaptcha",e.VALIDATE_CAPTCHA="VKSDKOneTapValidateCaptcha"}(ce||(ce={})),function(e){e.CLOSE_AUTH="VKSDKOneTapAuthClose",e.ADAPTIVITY_CHANGE="VKSDKFloatingOneTapAdaptivityChange",e.ADAPTIVITY_CHANGED="VKSDKFloatingOneTapAdaptivityChanged"}(le||(le={})),function(e){e.SHOW_LOGIN="VKSDKButtonOneTapAuthShowLogin",e.SHOW_LOGIN_OPTIONS="VKSDKButtonOneTapAuthShowLoginOptions",e.SHOW_AGREEMENTS_DIALOG="VKSDKButtonOneTapAuthShowAgreementsDialog",e.START_AUTHORIZE="VKSDKButtonOneTapAuthStartAuthorize"}(ue||(ue={})),function(e){e.WRONG_TOKEN="VKSDKBindAccountErrorWrongToken",e.ALREADY_BIND="VKSDKBindAccountErrorAlreadyBind"}(de||(de={}));var he,_e,ge=function(){function e(){}return e.flags=null,e.silentAuth=function(){var e=J.get(),t="https://"+e.loginDomain+"/?act=connect&app_id="+e.appId+"&response_type=silent_token&uuid="+$()+"&v=1.43.0",n=new XMLHttpRequest;return n.open("GET",t,!0),n.responseType="json",n.withCredentials=!0,new Promise((function(e,t){n.onload=function(){n.response?e({provider:"vk",payload:n.response}):t()},n.onerror=function(){t()},n.send()}))},e.oneTapAuth=function(t,n){if(console.warn("Connect.oneTapAuth method is deprecated. Use Connect.floatingOneTapAuth and Connect.buttonOneTapAuth methods."),!["floating","button"].includes(t))return null;switch(t){case"button":return e.buttonOneTapAuth(n);case"floating":return e.floatingOneTapAuth(n);default:return null}},e.floatingOneTapAuth=function(t){var n=function(){var e,t=window.innerWidth,n=t<=768;return{destroy:function(){return window.removeEventListener("resize",e)},isAdaptive:function(){return n},observe:function(o){e=function(){var e=window.innerWidth;t>768&&e<=768?o(n=!0):t<=768&&e>768&&o(n=!1),t=e},window.addEventListener("resize",e)}}}(),o=function(e,t){var n,o,i,r={},a=e?"314px":"334px",s=e?"\n      display: none;\n      position: fixed;\n      bottom: 0;\n      right: 50%;\n      transform: translate(50%, 0);\n      max-width: 468px;\n      width: 100%;\n      height: "+a+";\n    ":"\n        display: none;\n        position: fixed;\n        top: 0;\n        right: 0;\n        max-width: 400px;\n        width: 100%;\n        height: "+a+";\n      ";return(null===(n=null==t?void 0:t.styles)||void 0===n?void 0:n.zIndex)&&isFinite(null===(o=null==t?void 0:t.styles)||void 0===o?void 0:o.zIndex)&&(s+="z-index: "+(null===(i=null==t?void 0:t.styles)||void 0===i?void 0:i.zIndex)+";"),t&&(r.skip_success=C(t.skipSuccess,0)),{pageUrl:"floating_one_tap_auth",pageUrlParams:B({adaptive:e?1:0},r),frameStyles:s}}(n.isAdaptive(),t.options);if(!o)throw new Error("options were not set");var i=$(),r=A(ee(B({origin:location.protocol+"//"+location.host,uuid:i},o.pageUrlParams),o.pageUrl),{cssText:o.frameStyles}),a=new z({iframe:r,origin:"https://"+J.get().connectDomain});n.observe((function(e){a.sendMessage({handler:le.ADAPTIVITY_CHANGE,params:{uuid:i,is_adaptive:e}}),e?(r.style.maxWidth="468px",r.style.top="auto",r.style.bottom="0",r.style.right="50%",r.style.transform="translate(50%, 0)"):(r.style.maxWidth="400px",r.style.top="0",r.style.bottom="auto",r.style.right="0",r.style.transform="none"),r.style.display="none"})),document.body.appendChild(r);var s=function(){a.sendMessage({handler:ce.RESIZE_FRAME,params:{uuid:i}})};window.addEventListener("resize",s);var c=function(){r&&(r.remove(),r=null),window.removeEventListener("resize",s),n&&n.destroy(),a.destroy()},l=new Promise((function(n){a.onMessage((function(o){if(o.params.uuid===i)switch(o.handler){case ce.NOT_AUTHORIZED:t.callback({type:o.handler,payload:{uuid:i,error:"not_authorized"}}),c(),n(o.handler);break;case ce.RESIZE_FRAME:r.style.height=o.params.height+"px";break;case le.CLOSE_AUTH:t.callback({type:o.handler,payload:{uuid:i}}),c();break;case le.ADAPTIVITY_CHANGED:r.style.display="block";break;case ce.AUTH_DATA_LOADED:r.style.display="block",n(o.handler);default:e.handleOneTapEvents(o,a,t)}}))}));return{getFrame:function(){return r},destroy:c,authReadyPromise:l}},e.buttonOneTapAuth=function(t){var n=function(e){var t,n,o,i,r,a,s={},c=44,l=56;return e&&(s.display=e.displayMode&&ie.includes(e.displayMode)?e.displayMode:te.Default,s.button_skin=e.buttonSkin&&pe.includes(e.buttonSkin)?e.buttonSkin:oe.Primary,s.show_agreements=C(e.showAgreements,0),s.show_alternative_login=C(e.showAlternativeLogin,0),s.show_agreements_dialog=C(e.showAgreementsDialog,1),void 0!==(null===(t=e.buttonStyles)||void 0===t?void 0:t.height)&&(c=Number(null===(n=e.buttonStyles)||void 0===n?void 0:n.height),l=Number(null===(o=e.buttonStyles)||void 0===o?void 0:o.height)+12,s.style_height=null===(i=e.buttonStyles)||void 0===i?void 0:i.height),void 0!==(null===(r=e.buttonStyles)||void 0===r?void 0:r.borderRadius)&&(s.style_border_radius=null===(a=e.buttonStyles)||void 0===a?void 0:a.borderRadius),void 0!==e.langId&&(s.lang_id=ne.includes(e.langId)?e.langId:0),c+=s.show_alternative_login?l:0,c+=s.show_agreements?80:0),{pageUrl:"button_one_tap_auth",pageUrlParams:s,frameStyles:"\n        height: "+c+"px;\n      "}}(t.options);if(!n)throw new Error("options were not set");var o=$(),i=A(ee(B({origin:location.protocol+"//"+location.host,uuid:o},n.pageUrlParams),n.pageUrl),{cssText:n.frameStyles}),r=t.container;r&&r.appendChild(i);var a=new z({iframe:i,origin:"https://"+J.get().connectDomain}),s=function(){a.sendMessage({handler:ce.RESIZE_FRAME,params:{uuid:o}})};return window.addEventListener("resize",s),{getFrame:function(){return i},destroy:function(){i&&(i.remove(),i=null),window.removeEventListener("resize",s),a.destroy()},authReadyPromise:new Promise((function(n){a.onMessage((function(r){if(r.params.uuid===o)switch(r.handler){case ce.RESIZE_FRAME:i.style.height=r.params.height+"px";break;case ce.NOT_AUTHORIZED:n(r.handler);break;case ue.SHOW_LOGIN:case ue.SHOW_LOGIN_OPTIONS:t.callback({type:r.handler,payload:{uuid:o}});break;case ue.SHOW_AGREEMENTS_DIALOG:e.userPolicyAgreements(o).show().then((function(e){e&&e.accepted&&a.sendMessage({handler:ue.START_AUTHORIZE,params:{uuid:o}})})).catch((function(){a.sendMessage({handler:ae.DECLINE_POLICY_AGREEMENTS,params:{uuid:o}})}));break;case ce.AUTH_DATA_LOADED:n(r.handler);default:e.handleOneTapEvents(r,a,t)}}))}))}},e.handleOneTapEvents=function(t,n,o){var i=t.params.uuid;switch(t.handler){case ce.AUTH_DATA_LOADED:n.sendMessage({handler:ce.RESIZE_FRAME,params:{uuid:i}});break;case ce.LOGIN_SUCCESS:o.callback({type:t.handler,provider:"vk",payload:t.params});break;case ce.SHOW_CAPTCHA:var r=e.captcha(i,{captcha_sid:t.params.captcha_sid,captcha_img:t.params.captcha_img});r.show().then((function(e){n.sendMessage({handler:se.CAPTCHA_SUCCESS,params:B({uuid:i},e)})})).catch((function(){n.sendMessage({handler:se.CAPTCHA_FAIL,params:{uuid:i}}),r.destroy()}));break;case re.SHOW_DATA_POLICY:e.userDataPolicy(i).show().then((function(){o.callback({type:re.DATA_POLICY_RESULT,payload:{uuid:i,policyAccepted:!0}})})).catch((function(){o.callback({type:re.DATA_POLICY_RESULT,payload:{uuid:i,policyAccepted:!1}})}));break;case ce.FULL_AUTH_NEEDED:case ce.PHONE_VALIDATION_NEEDED:o.callback({type:t.handler,payload:{uuid:i}})}},e.userDataPolicy=function(t){var n=ee({origin:location.protocol+"//"+location.host,uuid:t},"user_data_policy"),o=window.innerHeight,i=A(n,{properties:{height:o+"px"},cssText:"\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: "+o+"px;\n      min-height: "+o+"px;\n      border: none;\n      z-index: 99999;\n    "});document.body.appendChild(i);var r=new z({iframe:i,origin:"https://"+J.get().connectDomain}),a=function(){i.style.display="none"};return{show:function(){return i.style.display="block",new Promise((function(n,o){r.onMessage((function(s){switch(s.handler){case re.HIDE_DATA_POLICY:a(),n(void 0);break;case re.SHOW_CAPTCHA:var c=e.captcha(t,{captcha_sid:s.params.captcha_sid,captcha_img:s.params.captcha_img});c.show().then((function(e){r.sendMessage({handler:se.CAPTCHA_SUCCESS,params:B({uuid:t},e)}),i.style.display="block"})).catch((function(){r.sendMessage({handler:se.CAPTCHA_FAIL,params:{uuid:t}}),c.destroy()})),a();break;default:a(),o()}}))}))},hide:a,destroy:function(){document.body.removeChild(i),r.destroy()}}},e.userPolicyAgreements=function(t){var n,o=A(ee({origin:location.protocol+"//"+location.host,uuid:t},"user_policy_agreements"),{properties:{height:(n=window.innerHeight)+"px"},cssText:"\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: "+n+"px;\n      min-height: "+n+"px;\n      border: none;\n      z-index: 99999;\n    "});document.body.appendChild(o);var i=new z({iframe:o,origin:"https://"+J.get().connectDomain}),r=function(){o.style.display="none"};return{show:function(){return o.style.display="block",new Promise((function(n,a){i.onMessage((function(i){switch(i.handler){case ae.ACCEPT_POLICY_AGREEMENTS:r(),n({accepted:!0});break;case ae.DECLINE_POLICY_AGREEMENTS:r(),n({accepted:!1});break;case ae.SHOW_DATA_POLICY:r();var s=function(){o.style.display="block"};e.userDataPolicy(t).show().then(s).catch(s);break;case ae.POLICY_AGREEMENTS_ERROR:case ae.HIDE_POLICY_AGREEMENTS:default:r(),a()}}))}))},hide:r,destroy:function(){document.body.removeChild(o),i.destroy()}}},e.captcha=function(e,t){var n=ee(B({origin:location.protocol+"//"+location.host,uuid:e},t),"auth_captcha"),o=window.innerHeight,i=A(n,{cssText:"\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: "+o+"px;\n      min-height: "+o+"px;\n      border: none;\n      z-index: 99999;\n    "});document.body.appendChild(i);var r=new z({iframe:i,origin:"https://"+J.get().connectDomain}),a=function(){document.body.removeChild(i),r.destroy()};return{show:function(){return i.style.display="block",new Promise((function(e,t){r.onMessage((function(n){if(n.handler===se.CAPTCHA_SUCCESS)e(n.params),a();else t(),a()}))}))},destroy:a}},e.userVisibleAuth=function(t){var n=$(),o=J.get(),i=B({origin:location.protocol+"//"+location.host,uuid:n,debug:C(o._debug,0),localhost:C(o._debug,0)},P(t,["screen","source"])),r=X(null==t?void 0:t.action);r&&(i.action=r);var a=ee(i);e.flags&&(a=a+"#"+y(e.flags));var s=screen.height/2-280,c=screen.width/2-410,l=window.open(a,"_blank","top="+s+",left="+c+",width=820,height=560,location");if(!l){var u={code:N.CONNECT_WINDOW_NOT_OPENED,reason:"Connect window was not opened."};return Promise.reject(u)}return new Promise((function(e,t){var o=setInterval((function(){if(!l||l.closed){window.removeEventListener("message",i),clearInterval(o);var e={code:N.CONNECT_WINDOW_CLOSED,reason:"Connect window was closed."};t(e)}}),1e3);function i(r){if(r.source===l&&l)if(window.removeEventListener("message",i),clearInterval(o),".vk.com"===r.origin.slice(r.origin.length-".vk.com".length))if(r.data.action==="vk_connect_response"+n){var a=r.data.payload;l.close(),a.error?(c={code:N.CONNECT_CLIENT_SDK_ERROR,reason:K(a.error)},t(c)):e({provider:"vk",payload:a})}else if(r.data.action==="oauth_callback"+n)e({provider:r.data.payload.name}),l.close();else if(r.data.action==="skip_callback"+n){var s=r.data.payload.redirectURL;s&&(window.location.href=s),l.close()}else r.data.action==="bind_ok_account"+n?(e(r.data.payload),l.close()):(l.close(),c={code:N.CONNECT_UNKNOWN_SDK_MESSAGE,reason:U(JSON.stringify(r.data))},t(c));else{l.close();var c={code:N.CONNECT_DOMAIN_NOT_ALLOWED,reason:M(r.origin)};t(c)}}window.addEventListener("message",i)}))},e.redirectAuth=function(e){var t=$(),n=B({redirect_uri:e.url,uuid:t},P(e,["screen","source"])),o=X(null==e?void 0:e.action);o&&(n.action=o),(null==e?void 0:e.state)&&(n.redirect_state=e.state);var i=ee(n);location.assign(i)},e.logout=function(){var e=J.get(),t=e.connectDomain,n=e.appId,o=e.superAppTokenV2;if(!o)return Promise.reject(F("superappToken","SuperappToken is undefined"));var i=y({origin:location.protocol+"//"+location.host,host_app_id:n,superapp_token:o}),r=fetch("https://"+t+"/logout?"+i,{credentials:"include"});return J.events.emit(w.LOGOUT),J.setSuperAppToken(""),J.setSuperAppToken("",{version:2}),r},e}(),me=["open_account"];!function(){function e(){}e.open=function(e){var t,n=$(),o=J.get(),i=B({origin:location.protocol+"//"+location.host,uuid:n,debug:C(o._debug,0),localhost:C(o._localhost,0)},P(e,["screen","source"])),r=(t=null==e?void 0:e.action)&&me.includes(t.name)?btoa(JSON.stringify(t)):"";r&&(i.action=r);var a=function(e){var t=J.get(),n=t.appId,o=t.connectDomain,i=t.appSettings,r=B({app_id:n,response_type:"silent_token",v:"1.43.0"},e);return i&&T(i)&&(r.app_settings=R(i)),"https://"+o+"/open_account?"+y(r)}(i);if(!window.open(a,"_blank")){var s={code:N.CONNECT_WINDOW_NOT_OPENED,reason:"Connect window was not opened."};return Promise.reject(s)}return Promise.resolve()}}();!function(e){e.INTERNAL_RESIZE="VKSDKMessengerInternalResize",e.INTERNAL_LOGOUT="VKSDKMessengerInternalLogout"}(he||(he={})),function(e){e.CLOSE_CHAT="VKSDKMessengerCloseChat"}(_e||(_e={}));var fe=function(){function e(){var e=this;this.resolve=function(t){if(Boolean(e.promise))return e.finished=!0,e.active=!1,e.resolveHandler(t)},this.reject=function(t){if(Boolean(e.promise))return e.finished=!0,e.active=!1,e.rejectHandler(t)}}return e.prototype.start=function(){var e=this;this.active=!0,this.finished=!1,this.promise=new Promise((function(t,n){e.resolveHandler=t,e.rejectHandler=n}))},e.prototype.get=function(){return this.promise},e}(),ve=function(){function e(){}return e.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e}(),Ee=function(){function e(){var e=this;this.config={},this.params={},this.loadingTask=new fe,this.initTask=new fe,this.cssText="",this.handleError=function(t){var n={data:t,code:N.CUSTOM};e.events.emit(w.ERROR,n)},this.events=V(),this.handleBridgeMessage=this.handleBridgeMessage.bind(this),this.handleChangeSuperAppToken=this.handleChangeSuperAppToken.bind(this),this.close=this.close.bind(this),this.handleLogout=this.handleLogout.bind(this)}return e.prototype.preload=function(e){var t=this;return this.validateParams(e).then((function(){return t.updateParams(e),t.createIframe(),t.initTask.start(),t.loadingTask.start(),t.timeoutTimer=setTimeout((function(){if(!t.initTask.finished){var e={code:N.LOADING_ERROR,reason:"Loading timeout"};t.initTask.reject(e)}}),5e3),t.iframe.onload=function(){t.iframe.onload=null,t.loadingTask.resolve()},t.bridge=new z({iframe:t.iframe,origin:"https://"+J.get().connectDomain}),t.bridge.onMessage(t.handleBridgeMessage),J.events.on(x.SUPERAPP_TOKEN_CHANGE_V2,t.handleChangeSuperAppToken),J.events.on(w.LOGOUT,t.close),window.document.body.appendChild(t.iframe),t.loadingTask.get()}))},e.prototype.open=function(e){var t=this;return this.validateParams(e).then((function(){return t.initTask.finished?(t.updateParams(e),Promise.resolve()):t.initTask.active||t.initTask.finished?(t.updateParams(e),t.initTask.get()):t.preload(e).then((function(){return t.initTask.get()}))}))},e.prototype.update=function(e,t){e&&this.updateParams(e),t&&this.updateConfig(t)},e.prototype.close=function(){this.iframe&&this.iframe.remove(),this.bridge&&this.bridge.destroy(),J.events.off(x.SUPERAPP_TOKEN_CHANGE_V2,this.handleChangeSuperAppToken),J.events.off(w.LOGOUT,this.close),delete this.iframe,delete this.bridge,this.loadingTask=new fe,this.initTask=new fe,this.events.emit(w.CLOSE)},e.prototype.sendMessage=function(e){this.bridge.sendMessage(e)},e.prototype.on=function(e,t){this.events.on(e,t)},e.prototype.off=function(e,t){this.events.off(e,t)},e.prototype.handleInit=function(){this.initTask.finished||(clearTimeout(this.timeoutTimer),this.initTask.resolve()),this.sendUpdateParamsMessage(),this.iframe.style.display="block"},e.prototype.handleRequestAuth=function(){J._auth({version:2})},e.prototype.handleRequestSuperAppToken=function(e){J._requestSuperAppToken(e,{version:2})},e.prototype.handleChangeSuperAppToken=function(e){this.bridge.sendMessage({handler:w.REQUEST_SUPERAPP_TOKEN+"Success",params:{result:e}})},e.prototype.handleBridgeMessage=function(e){switch(ve.log(e),e.handler){case b.INIT:this.handleInit();break;case w.REQUEST_SUPERAPP_TOKEN:this.handleRequestSuperAppToken(e.params);break;case w.AUTH_NEEDED:this.handleRequestAuth();break;case w.CLOSE:this.close();break;case w.ERROR:this.handleError(e.params);break;default:return}},e.prototype.handleLogout=function(){J._logout()},e.prototype.handleAfterUpdateParams=function(){this.sendUpdateParamsMessage()},e.prototype.handleAfterUpdateConfig=function(){},e.prototype.handleAfterCreateIframe=function(){},e.prototype.validateParams=function(e){return Promise.resolve(e)},e.prototype.createIframe=function(){var e=this.getIframeUrl();this.iframe=A(e,{cssText:this.cssText}),this.handleAfterCreateIframe()},e.prototype.getIframeUrl=function(){return""},e.prototype.getIframeUrlParams=function(){var e=J.get(),t=e._debug,n=e.superAppTokenV2,o=e.appId;return y(B(B({},this.params),{host_app_id:o,superapp_token:n,debug:C(t,0),localhost:C(t,0),origin:location.protocol+"//"+location.host}))},e.prototype.updateConfig=function(e){this.config=O(this.config,e),this.handleAfterUpdateConfig()},e.prototype.updateParams=function(e){this.params=O(this.params,e||{}),this.handleAfterUpdateParams()},e.prototype.sendUpdateParamsMessage=function(){this.bridge&&this.initTask.finished&&this.bridge.sendMessage({params:this.params,handler:w.UPDATE_PARAMS})},e}(),Se={styles:{bottom:"0",right:"0",zIndex:99999}},ye=function(e){function t(t){var n=e.call(this)||this;return n.config=Se,n.cssText="\n    border: none;\n    display: none;\n    position: fixed;\n  ",n.updateStyles=function(){if(n.iframe){var e=n.config.styles,t=isFinite(e.zIndex)?e.zIndex:999999;n.iframe.style.zIndex=""+t,n.iframe.style.bottom=e.bottom,n.iframe.style.right=e.right}},n.createCaptcha=function(e,t){var n=ee(B({origin:location.protocol+"//"+location.host,uuid:e},t),"auth_captcha"),o=window.innerHeight,i=A(n,{cssText:"\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: "+o+"px;\n      min-height: "+o+"px;\n      border: none;\n      z-index: 99999;\n    "});document.body.appendChild(i);var r=new z({iframe:i,origin:"https://"+J.get().connectDomain}),a=function(){document.body.removeChild(i),r.destroy()};return{show:function(){return i.style.display="block",new Promise((function(e,t){r.onMessage((function(n){if(n.handler===se.CAPTCHA_SUCCESS)e(n.params),a();else t(),a()}))}))},destroy:a}},n.updateConfig(t),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}H(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.handleBridgeMessage=function(t){var n=this;switch(e.prototype.handleBridgeMessage.call(this,t),t.handler){case w.GET_CAPTCHA:var o=t.params.uuid,i=this.createCaptcha(o,{captcha_sid:t.params.captcha_sid,captcha_img:t.params.captcha_img});i.show().then((function(e){n.bridge.sendMessage({handler:w.GET_CAPTCHA+"Success",params:B({uuid:o},e)})})).catch((function(){n.bridge.sendMessage({handler:w.GET_CAPTCHA+"Fail",params:{uuid:o}}),i.destroy()}));break;case he.INTERNAL_RESIZE:this.handleInternalIframeResize(t);break;case he.INTERNAL_LOGOUT:this.handleLogout();break;case _e.CLOSE_CHAT:this.events.emit(_e.CLOSE_CHAT,t.params);break;default:return}},t.prototype.handleInternalIframeResize=function(e){var t=e.params;this.iframe.width=t.width+"px",this.iframe.height=t.height+"px"},t.prototype.handleAfterUpdateConfig=function(){this.updateStyles()},t.prototype.handleAfterCreateIframe=function(){this.updateStyles()},t.prototype.validateParams=function(e){return e.peer_id>=0?Promise.reject(F("peer_id","Peer id can`t be positive")):Promise.resolve(e)},t.prototype.getIframeUrl=function(){return"https://"+J.get().connectDomain+"/messenger?"+this.getIframeUrlParams()},t}(Ee)},601939:(e,t,n)=>{var o=n(279366);window.Join=o.join;try{stManager.done(jsc("web/join.js"))}catch(e){}},279366:(e,t,n)=>{n.d(t,{join:()=>O});n(991181),n(579665),n(95767),n(530522),n(175115),n(66108),n(296253),n(283946),n(21466),n(59357);var o=n(726271),i=n(635676),r=n(803834),a=n(315544),s=n(386409),c=n(695724),l=n(49535),u=n(654612),d=n(486125),p=n(786067),h=n(376852),_=n(70488),g=n(337668),m=n(267394),f=n(559367),v=n(47647),E=n(517957);function S(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i,r=!0,a=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return r=e.done,e},e:function(e){a=!0,i=e},f:function(){try{r||null==o.return||o.return()}finally{if(a)throw i}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function I(){return I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},I.apply(this,arguments)}function T(e,t){cur[`${e}IsDirty`]||(cur[`${e}IsDirty`]=!0,t())}function R(){var e;(null===(e=cur)||void 0===e?void 0:e.fbSign)&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.FACEBOOK_REGISTRATION,_.EventFieldValues.REGISTERED_VIA_FB)}function A(){var e,t=(0,a.ge)("join_phone");t&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.PHONE_NUMBER,t.value,!0),(null===(e=cur)||void 0===e?void 0:e.uiPhoneCountry)&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.PHONE_COUNTRY,cur.uiPhoneCountry.val(),!0)}var O={show(e){(0,a.isVisible)(e)||(0,i.slideDown)(e,150)},hide(e){(0,a.isVisible)(e)&&(0,i.slideUp)(e,150)},scrollnode:()=>o.browser.msie6?pageNode:window,scrollResize(e,t){if(!o.browser.mobile||o.browser.safari_mobile){var n=(0,r.scrollGetY)();!0===t&&(cur.nextButtonTop=(0,a.getXY)(cur.nextButtonWrap)[1],o.browser.msie6&&(cur.nextButtonTop+=n));var i=cur.resultShown&&n+lastWindowHeight<cur.nextButtonTop+cur.nextButtonHeight+(0,c.intval)((0,a.getStyle)("content","marginTop"))+(0,a.ge)("page_header_cont").offsetHeight-8;i&&!cur.docked?((0,a.addClass)(cur.nextButton,"fixed"),o.browser.msie6&&(bodyNode.appendChild(cur.nextButton),e={type:"resize"}),cur.docked=!0):!i&&cur.docked&&((0,a.removeClass)(cur.nextButton,"fixed"),o.browser.msie6&&cur.nextButtonWrap.appendChild(cur.nextButton),cur.docked=!1),cur.docked&&e&&"resize"===e.type&&(o.browser.msie6?cur.nextButton.style.left=(0,a.getXY)((0,a.ge)("content"))[0]+"px":(cur.nextButton.style.left=(0,a.ge)("page_layout").offsetLeft+(0,a.ge)("content").offsetLeft+"px",setTimeout(O.nextResetStyle,0)))}},nextResetStyle(){cur.nextButton.style.left=""},initScroll(){(0,c.extend)(cur,{nextButton:(0,a.ge)("join_"+cur.section+"_next"),nextButtonWrap:(0,a.ge)("join_"+cur.section+"_next_wrap"),resultEl:(0,a.ge)("join_"+cur.section+"_result")}),cur.nextButtonHeight=(0,a.getSize)(cur.nextButton)[1],cur.nextButtonWrap.style.height=cur.nextButtonHeight+"px",cur.resultShown=(0,a.isVisible)(cur.resultEl),O.scrollResize(!1,!0),(0,l.addEvent)(O.scrollnode(),"scroll",O.scrollResize),(0,l.addEvent)(window,"resize",O.scrollResize),cur.destroy.push((e=>{(0,l.removeEvent)(O.scrollnode(),"scroll",O.scrollResize),(0,l.removeEvent)(window,"resize",O.scrollResize),o.browser.msie6&&e.nextButtonWrap.appendChild(e.nextButton)}))},initStatsPhoneVerify(){var e=(0,a.ge)("join_called_phone"),t=(0,a.ge)("join_called_code"),n=(0,a.ge)("join_code"),o=()=>{cur.isCalledPhoneElDirty||(_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.INPUT_CODE_INTERACTION,cur.eventScreen),cur.isCalledPhoneElDirty=!0)};A(),_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.SMS_CODE,n.value,!0),cur.statsPhoneVerifyInited||(e.addEventListener("keyup",(()=>{_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.SMS_CODE,e.value),o()})),t.addEventListener("keyup",(()=>{_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.SMS_CODE,t.value),o()})),n.addEventListener("keyup",(()=>{_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.SMS_CODE,n.value),o()})),cur.statsPhoneVerifyInited=!0)},initStatsPhone(){var e=(0,a.ge)("join_phone");_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.PHONE_NUMBER,e.value,!0),cur.statsPhoneInited||(e.addEventListener("keyup",(()=>{_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.PHONE_NUMBER,e.value),cur.isPhoneElDirty||(_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.INPUT_NUMBER_INTERACTION,cur.eventScreen),cur.isPhoneElDirty=!0)})),cur.statsPhoneInited=!0)},initStatsPassword(){var e=(0,a.ge)("join_pass");_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.PASSWORD,e.value,!0),cur.statsPasswordInited||(e.addEventListener("keyup",(()=>{_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.PASSWORD,e.value)})),cur.statsPasswordInited=!0)},initStatsRules(){var e=(0,a.ge)("join_accept_terms_checkbox");_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.RULES_ACCEPT,O.policyChecked()+"",!0),cur.statsRulesInited||(e.addEventListener("click",(()=>{_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.RULES_ACCEPT,O.policyChecked()+"")})),cur.statsRulesInited=!0)},initStats(){cur.eventScreen=_.EventScreens.REGISTRATION_PHONE,((0,a.isVisible)("join_code_row")||(0,a.isVisible)("join_called_phone_row")||(0,a.isVisible)("join_called_code_row"))&&(cur.eventScreen=_.EventScreens.REGISTRATION_PHONE_VERIFY),(0,a.isVisible)("join_pass_row")&&(cur.eventScreen=_.EventScreens.REGISTRATION_PASSWORD),"done"===nav.objLoc.act&&(cur.eventScreen=_.EventScreens.REGISTRATION_COMPLETE),"contacts"===nav.objLoc.act&&(cur.eventScreen=_.EventScreens.REGISTRATION_COUNTRY),"education"===nav.objLoc.act&&(cur.eventScreen=_.EventScreens.REGISTRATION_EDUCATION),"email"===nav.objLoc.act&&(cur.eventScreen=_.EventScreens.REGISTRATION_EMAIL),cur.eventScreen===_.EventScreens.REGISTRATION_PHONE&&(O.initStatsPhone(),O.initStatsRules()),cur.eventScreen===_.EventScreens.REGISTRATION_PHONE_VERIFY&&(O.initStatsPhoneVerify(),O.initStatsRules()),cur.eventScreen===_.EventScreens.REGISTRATION_PASSWORD&&(O.initStatsPassword(),O.initStatsRules()),cur.eventScreen===_.EventScreens.REGISTRATION_COUNTRY&&(_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.COUNTRY,`${cur.uiCountry.val()}`,!0),_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.CITY,`${cur.uiCity.val()}`,!0)),cur.eventScreen===_.EventScreens.REGISTRATION_EDUCATION&&(_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.COUNTRY,`${cur.selData.country_val[0]}`,!0),_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.CITY,`${cur.selData.city_val[0]}`,!0),_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.GRADUATION,"",!0),cur.isSchool?(_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.SCHOOL,"",!0),_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.YEAR_FROM,"",!0),_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.YEAR_TO,"",!0),_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.CLASS,"",!0),_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.SPECIALIZATION,"",!0)):(_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.UNIVERSITY,"",!0),_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.FACULTY,"",!0),_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.CHAIR,"",!0),_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.EDU_FORM,"",!0),_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.EDU_STATUS,"",!0))),cur.eventScreen===_.EventScreens.REGISTRATION_EMAIL&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.EMAIL,"",!0)},showProgress(){if((0,a.isVisible)(cur.resultEl)){var e=(0,a.ge)("join_"+cur.section+"_summary");e.lastChild&&(0,a.hasClass)(e.lastChild,"progress_inline")||e.appendChild((0,a.ce)("span",{className:"progress_inline join_summary_prg"}))}else(0,a.show)("join_"+cur.section+"_none_prg"),cur.noneEl.style.visibility="hidden"},hideProgress(){if((0,a.isVisible)(cur.resultEl)){var e=(0,a.ge)("join_"+cur.section+"_summary");e.lastChild&&(0,a.hasClass)(e.lastChild,"progress_inline")&&(0,a.re)(e.lastChild)}else cur.noneEl.style.visibility="",(0,a.hide)("join_"+cur.section+"_none_prg")},addFriendLogged:function(e,t,n){T(_.RegistrationFieldItemNames.FRIEND_ASK,(function(){_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.FRIEND_ASK,"1"),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.FIRST_FRIEND_ASK,_.EventScreens.REGISTRATION_LIST_FRIENDS_FACEBOOK,void 0,{force:!0})})),ajax.post("al_friends.php",{act:"add",mid:t,hash:n,from:"fb_sign"},{onDone:()=>{(0,a.hide)("join_add"+t),(0,a.show)("join_request"+t)},showProgress:s.lockButton.pbind(e),hideProgress:s.unlockButton.pbind(e)})},removeFriendLogged:function(e,t,n){ajax.post("al_friends.php",{act:"remove",mid:t,hash:n,from:"fb_sign"},{onDone:()=>{(0,a.show)("join_add"+t),(0,a.hide)("join_request"+t)},showProgress:s.lockButton.pbind(e),hideProgress:s.unlockButton.pbind(e)})},isPhoneCall(){var e=parseInt(cur.validationType,10);return 3===e||4===e},isPhoneCallStrict:()=>3===parseInt(cur.validationType,10),phoneDone:function(e,t){if(e){var n=(0,a.ge)("join_phone");cur.uiPhoneCountry&&cur.uiPhoneCountry.val(t,!0),(0,a.val)(n,e),n.readOnly=!0,cur.uiPhoneCountry&&(cur.uiPhoneCountry.disable(!0),(0,a.addClass)("join_phone_prefixed","join_readonly_wrap")),(0,a.addClass)(n,"join_readonly")}cur.resendInt&&clearInterval(cur.resendInt),cur.resendInt=setInterval(O.resendUpdate,1e3),(0,a.show)("join_code_submit","join_other_phone","join_resend"),(0,a.hide)("join_phone_submit"),O.isPhoneCall()?((0,a.val)((0,a.ge)("join_called_phone_prefix").firstChild,""),(0,a.val)("join_called_phone",""),(0,a.hide)("join_code_row"),(0,a.hide)("join_called_code_row"),(0,i.slideDown)("join_called_phone_row",150,a.elfocus.pbind("join_called_phone"))):(0,a.isVisible)("join_called_phone_row")||(0,a.isVisible)("join_called_code_row")?((0,a.hide)("join_called_phone_row"),(0,a.show)("join_code_row"),setTimeout(a.elfocus.pbind("join_code"),100)):(0,i.slideDown)("join_code_row",150,a.elfocus.pbind("join_code")),(0,a.val)("join_submit_result",""),(0,a.val)("join_code",""),O.initPhoneCode()},checkStatus:function(e,t){var n=(0,d.curBox)(),o=n?n.showProgress:s.lockButton.pbind("join_send_phone"),i=n?n.hideProgress:s.unlockButton.pbind("join_send_phone");if(cur.checkingStatus){if(cur.checkingStatus<0)o(),cur.checkingStatus=1;else if(++cur.checkingStatus,cur.checkingStatus>4)return cur.checkingStatus=-1,i(),O.phoneDone(e,t)}else o(),cur.checkingStatus=1,cur.destroy.push((function(){clearTimeout(cur.checkingTimer),i()}));cur.checkingTimer=setTimeout(ajax.post("join.php",{act:"phone_check"},{onDone:n=>{if(n||cur.checkingStatus>3)return cur.checkingStatus=-1,i(),O.phoneDone(e,t);cur.checkingTimer=setTimeout(O.checkStatus.pbind(e,t),2e3)},onFail:n=>(cur.checkingStatus=-1,i(),n?(O.showMsg("join_submit_result",n,a.elfocus.pbind("join_phone")),!0):O.phoneDone(e,t))}),1e3)},submitPhone:e=>{if(e||!(0,s.isButtonLocked)("join_send_phone"))if(O.policyChecked()){var t=(0,a.ge)("join_phone"),n=O.getPhone(),o=(0,a.val)("join_phone"),i=!!cur.uiPhoneCountry&&cur.uiPhoneCountry.val_full();if(t.disabled)return(0,a.elfocus)("join_code");ajax.post("join.php",{act:"phone",phone:n,hash:cur.hash},{showProgress:s.lockButton.pbind("join_send_phone"),hideProgress:s.unlockButton.pbind("join_send_phone"),onDone:(e,t,n,r,c)=>{if(e)return(0,s.lockButton)("join_send_phone"),void setTimeout(O.submitPhone.pbind(!0),1e3);if(cur.strongCode!==n){var l=(0,a.ge)("join_code").tt;l&&l.destroy(),cur.strongCode=n}cur.validationType=c,cur.resendDelay=r,O.phoneDone(o,i),O.resendUpdate();var u=(0,a.isVisible)("join_code_submit")?_.EventScreens.REGISTRATION_PHONE:cur.eventScreen;R(),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.SCREEN_PROCEED,null!=u?u:_.EventScreens.REGISTRATION_PHONE,_.EventScreens.REGISTRATION_PHONE_VERIFY);var d=cur.uiPhoneCountry.val();String(cur.defCountry)!==String(d)&&(_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.SELECT_COUNTRY_NAME,d),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.PROCEED_OTHER_COUNTRY_CODE,cur.eventScreen)),O.initStats()},onFail:e=>{if(e){var t=(0,a.ge)("join_phone");return t&&t.tt&&t.tt.hide&&t.tt.hide({fasthide:!0}),O.showMsg("join_submit_result",e,a.elfocus.pbind("join_phone")),!0}}})}else(0,s.notaBene)("join_accept_terms_checkbox")},getStrength(e){var t=-1,n=["qwerty","йцукен","gfhjkm","пароль","password","abc123","fuckyou","123abc","baseball","football","soccer","monkey","liverpool","princess","jordan","slipknot","superman","iloveyou"];if(e!==e.replace(/\s/g,"")&&((0,a.val)("join_pass",e=e.replace(/\s/g,"")),(0,a.elfocus)("join_pass")),e.length<6)t=0;else if(e.match(/^\d+$/)||indexOf(n,e)>=0||e.substr(-1).match(/\d/)&&n.indexOf(e.substr(0,e.length-1))>=0)t=1;else{for(var o=[/[^a-z]/g,/[^A-Z]/g,/[^а-яё]/g,new RegExp("[^А-ЯЁ]","g"),/[^0-9]/g,new RegExp("[a-zA-Zа-яА-ЯёЁ0-9]","g")],i=[],r=0,s=0,l=o.length;s<l;++s){var u=e.replace(o[s],"").length;u&&(u>1&&++r,i.push({group:s,cnt:u}))}if(i.length<3&&parseInt(i[i.length-1].group,10)!==o.length-1&&r<2&&(t=2),(r>2||i.length>2&&parseInt(i[i.length-1].group,10)===o.length-1)&&(t=4),t<0&&r>1){var d=e.replace(o[o.length-1],"");d.length>1&&d.replace(new RegExp((0,c.escapeRE)(d.charAt(0)),"g"),"").length&&(t=4)}t<0&&(t=3),t&&t<3&&e.length>13&&++t}return t},updateStrength(){var e=(0,a.val)("join_pass"),t=O.getStrength(e);(0,a.ge)("join_about_pass").className="join_pwd_level"+t,(0,a.ge)("join_pass_strength").innerHTML=e?(0,p.getLang)("join_pwd_level"+t):(0,p.getLang)("join_pwd_min_length"),setQuickLoginData(cur.fbSign&&cur.fbValid?cur.fbEmail:O.getPhone(),e,{params:cur.joinParams})},initPhoneCode(){cur.codeForm||(setQuickLoginData(O.getPhone(),"",{params:cur.joinParams}),utilsNode.appendChild((0,a.ce)("div",{innerHTML:`\n<form method="POST" action="${vk.loginscheme}://${cur.loginHost}/?act=check_code&_origin=${locProtocol}//${locHost}" id="join_code_form" name="join_code_form" target="join_code_frame">\n  <input type="hidden" name="email" id="join_code_phone" />\n  <input type="hidden" name="code" id="join_code_code" />\n  <input type="hidden" name="call" id="join_code_call" />\n  <input type="hidden" name="recaptcha" id="join_code_recaptcha" />\n  <input type="hidden" name="captcha_sid" id="join_code_sid" />\n  <input type="hidden" name="captcha_key" id="join_code_key" />\n</form>\n<iframe id="join_code_frame" name="join_code_frame"></iframe>\n`})),cur.codeForm=(0,a.ge)("join_code_form"),cur.codeFrame=(0,a.ge)("join_code_frame"))},validatePaste:e=>{var t=(e||window).clipboardData.getData("Text").replace(/[^0-9]/g,""),n=(0,a.ge)("join_phone"),o=(0,a.ge)("join_phone_prefix").firstChild;if(!(t.length<11)){var i=t.slice(0,2);89!=i&&87!=i||(t="7"+t.slice(1));var r,s=S(cur.countries);try{for(s.s();!(r=s.n()).done;){var c=r.value,l=c[3].slice(1),u=l.length;if(t.slice(0,u)===l)return cur.uiPhoneCountry.val(c[0]),(0,a.val)(o,c[3].toString()),(0,a.val)(n,t.slice(u)),cancelEvent(e)}}catch(e){s.e(e)}finally{s.f()}}},initPhoneCountry:function(e,t){cur.countries=e,cur.defCountry=t;var n=(0,a.ge)("join_phone_country"),o=!!+n.dataset.vkConnectIntegration;cur.uiPhoneCountry=new Dropdown(n,cur.countries,{selectedItems:t,big_text:!0,disablePlaceholder:!0,liteEventsBind:!0,autocomplete:!0,multiselect:!1,onShow:function(){_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.SELECT_COUNTRY,cur.eventScreen)},onChange:function(e){var t=(0,a.ge)("join_phone"),n=(0,a.ge)("join_phone_prefix").firstChild,i=cur.uiPhoneCountry.val_full()[3];if(t.readOnly||0===e||"0"===e||""===e||!1===e||void 0===e){var r=(0,a.val)(n);if(i==r)return;for(var s=0,c=cur.countries.length;s<c;++s)if(cur.countries[s][3]==r)return cur.uiPhoneCountry.val(cur.countries[s]);return cur.uiPhoneCountry.val(cur.defCountry,!0)}(0,a.val)(n,i),o||O.updatePolicyLink(cur.uiPhoneCountry.val()),_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.SELECT_COUNTRY_NAME,cur.uiPhoneCountry.val()),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.SELECT_COUNTRY_DONE,cur.eventScreen),_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.PHONE_COUNTRY,cur.uiPhoneCountry.val())}}),(0,a.ge)("join_phone").readOnly?cur.uiPhoneCountry.disable(!0):_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.PHONE_COUNTRY,cur.uiPhoneCountry.val(),!0),cur.destroy.push(cur.uiPhoneCountry.destroy.bind(cur.uiPhoneCountry))},getPhone(){var e=(0,c.trim)((0,a.val)("join_phone"));return(0,c.trim)((0,a.val)(((0,a.ge)("join_phone_prefix")||{}).firstChild)||"")+e},submitPhoneCode(){if(cur.codeForm&&!(0,s.isButtonLocked)("join_send_code"))if(O.policyChecked()){var e,t,n;O.isPhoneCall()?(e="join_called_phone",t="join_called_phone_prefixed",n=cur.calledPhoneLen):(t=e="join_code",n=5);var o=(0,c.trim)((0,a.val)(e)).replace(/[^a-z0-9]/g,"");if(o.length<n)return(0,s.notaBene)(t);if("05937"===o)return O.showMsg("join_submit_result",(0,p.getLang)("join_sorry_code"),a.elfocus.pbind("join_code",!1,!1));(0,a.val)("join_code_phone",O.getPhone()),(0,a.val)("join_code_code",o),O.isPhoneCall()&&(0,a.val)("join_code_call",vk.id?-vk.id:getCookie("remixnreg_sid")),(0,s.lockButton)("join_send_code"),cur.codeForm.submit()}else(0,s.notaBene)("join_accept_terms_checkbox")},policyChecked(){var e=(0,a.geByClass1)("checkbox","join_accept_terms_checkbox");return(0,s.isChecked)(e)},togglePhoneSubmit(){var e=O.policyChecked();(0,s.disableButton)((0,a.ge)("join_send_phone"),!e),(0,s.disableButton)((0,a.ge)("join_send_code"),!e),(0,s.disableButton)((0,a.ge)("join_send_pass"),!e)},askPassword(e,t){(0,d.curBox)()&&(0,d.curBox)().hide(),cur.sureBoxText=t,(0,s.unlockButton)("join_send_code"),(0,a.val)("join_code",(0,a.val)("join_code_code"));var n=cur.joinParams&&cur.joinParams.facebook;cur.joinParams={join_code:(0,a.val)("join_code"),join_hash:e},n&&(cur.joinParams.facebook=1),O.isPhoneCall()?((0,a.ge)("join_called_phone").readOnly=!0,(0,a.addClass)((0,a.ge)("join_called_phone"),"join_readonly"),(0,a.addClass)((0,a.ge)("join_called_phone_prefixed"),"join_readonly_wrap")):((0,a.ge)("join_code").readOnly=!0,(0,a.addClass)((0,a.ge)("join_code"),"join_readonly")),(0,a.show)("join_pass_submit"),(0,a.hide)("join_other_phone","join_code_submit","join_resend","join_country_row"),(0,i.slideDown)("join_pass_row",150,a.elfocus.pbind("join_pass")),(0,a.val)("join_submit_result",""),R(),A(),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.SCREEN_PROCEED,cur.eventScreen,_.EventScreens.REGISTRATION_PASSWORD),O.initStats()},askCaptcha(e,t,n){cur.codeForm&&((0,s.unlockButton)("join_send_code"),2===parseInt(t,10)?window.badCodeBox=(0,u.showReCaptchaBox)(e,n,window.badCodeBox,{onSubmit:(e,t)=>{(0,a.val)("join_code_recaptcha",e),cur.codeForm.submit()},onHide:()=>{window.badCodeBox=!1}}):window.badCodeBox=(0,u.showCaptchaBox)(e,n,window.badCodeBox,{onSubmit:(e,t)=>{(0,a.val)("join_code_sid",e),(0,a.val)("join_code_key",t),cur.codeForm.submit()},onHide:()=>{window.badCodeBox=!1}}))},submitPasswordSure(){(0,u.showFastBox)((0,p.getLang)("join_new_page_sure_title"),(0,p.getLang)("join_new_page_sure"),(0,p.getLang)("join_new_page_sure_submit"),O.submitPassword.pbind(-1),(0,p.getLang)("global_cancel"))},submitPassword(e,t){if(!(0,s.isButtonLocked)("join_send_pass")||cur.submitOnSign)if(O.policyChecked()){var n;if(!0===t)n="000000";else if((n=(0,a.val)("join_pass")).length<6||O.getStrength(n)<3)return(0,s.notaBene)("join_pass");if(cur.sureBoxText&&1!==e&&-1!==e)(0,u.showFastBox)({title:(0,p.getLang)("join_sure_detach"),hideButtons:!0,width:560,noCloseButton:!0},cur.sureBoxText).changed=!0;else{if(cur.joinParams.join_to_already=(0,c.intval)(e),cur.fbSign&&!cur.fbSigned)return cur.submitOnSign=1,(0,s.lockButton)("join_send_pass");var o;window._oldOnLoginFailed||(window._oldOnLoginFailed=window.onLoginFailed,window._oldOnLoginDone=window.onLoginDone,cur.destroy.push((()=>{window.onLoginFailed=window._oldOnLoginFailed,window.onLoginDone=window._oldOnLoginDone,window._oldOnLoginFailed=!1,window._oldOnLoginDone=!1}))),window.onLoginFailed=(e,t)=>{(0,E.joinLogProgress)(v.JoinProgressLog.SCREEN_FINISH,v.JoinProgressLog.STATUS_ERROR,v.JoinProgressLog.ERROR_PASSWORD),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.INCORRECT_PASSWORD,cur.eventScreen),-1===e?location.href=location.href.replace(/^http:/,"https:"):4===e?location.href="/login?m=1&email="+t.email:7===e?location.href="/join?act=finish&m=1":10===e?((0,s.lockButton)("join_send_pass"),setTimeout(submitQuickLoginForm.pbind(o,n,{prg:"join_send_pass",params:cur.joinParams}),1e3)):nav.reload()},window.onLoginDone=nav.go.pbind("join?act=done"),cur.fbSign&&(cur.fbValid||!0===t)?(o=cur.fbEmail,cur.joinParams.fb_id=cur.fbId):(o=O.getPhone(),R(),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.SCREEN_PROCEED,cur.eventScreen,_.EventScreens.REGISTRATION_COMPLETE)),submitQuickLoginForm(o,n,{prg:"join_send_pass",params:cur.joinParams})}}else(0,s.notaBene)("join_accept_terms_checkbox")},showMsg(e,t,n,o){var i=(0,a.ge)(e);showMsg(i,t,o||"error",!0),(0,c.isFunction)(n)&&n()},codeFailed(e,t){(0,d.curBox)()&&(0,d.curBox)().hide(),(0,s.unlockButton)("join_send_code");var n,o=(0,p.getLang)("join_wrong_code");(e=(0,c.intval)(e))<0?(o=(0,p.getLang)("join_code_failed"),O.changePhone()):e&&e<6&&(o+="<br>"+(0,p.getLang)("join_tries_left").replace("{count}","<b>"+e+"</b>")),O.isPhoneCall()&&(0,a.isVisible)("join_called_phone_prefix")?(n="join_called_phone",(0,a.val)((0,a.ge)("join_called_phone_prefix").firstChild,t)):n="join_code",O.showMsg("join_submit_result",o,a.elfocus.pbind(n)),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.INCORRECT_SMS_CODE,cur.eventScreen),window._oldOnLoginFailed&&(window.onLoginFailed=window._oldOnLoginFailed)},resendUpdate(){var e,t;O.isPhoneCallStrict()?(e="join_send_code_sms_time",t="join_send_code_sms"):(e="join_resend_sms_time",t="join_no_sms"),cur.resendDelay>0?((0,a.val)("join_resend",(0,p.getLang)(e).replace("%s",Math.floor(cur.resendDelay/60)+":"+(cur.resendDelay%60<10?"0":"")+cur.resendDelay%60)),cur.resendDelay--):-1===parseInt(cur.resendDelay,10)?((0,a.val)("join_resend",""),clearInterval(cur.resendInt)):((0,a.val)("join_resend",'<a id="join_resend_lnk" onclick="return Join.noCode()">'+(0,p.getLang)(t)+"</a>"),clearInterval(cur.resendInt))},noCode(){var e=(0,a.ce)("span",{className:"progress_inline"}),t=(0,a.ge)("join_resend_lnk"),n=t.parentNode;return ajax.post("join.php",{act:"resend",hash:cur.hash},{showProgress:()=>{t.parentNode===n&&n.replaceChild(e,t)},hideProgress:()=>{e.parentNode===n&&n.replaceChild(t,e)},onDone:function(e,t,n,o){1===parseInt(e,10)?(cur.validationType=e,cur.resendDelay=t,O.phoneDone(),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.RESEND_SMS_CODE,cur.eventScreen)):t&&n?((0,a.val)("join_submit_result",""),(0,u.showFastBox)({title:e,width:450,noCloseButton:!0},t,n,O.call,o).changed=!0,_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.RESEND_SMS_CODE,cur.eventScreen)):t?((0,a.val)("join_submit_result",""),(0,u.showFastBox)({title:e,width:450},t),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.RESEND_SMS_CODE,cur.eventScreen)):(O.showMsg("join_submit_result",e),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.RESEND_SMS_CODE_FAILED,cur.eventScreen))}}),!1},changePhone(){var e=(0,a.ge)("join_phone");e.readOnly=!1,(0,a.removeClass)(e,"join_readonly"),cur.uiPhoneCountry&&(cur.uiPhoneCountry.disable(!1),cur.uiPhoneCountry.val(cur.uiPhoneCountry.val(),!0),(0,a.removeClass)("join_phone_prefixed","join_readonly_wrap")),(0,a.show)("join_phone_submit","join_country_row"),(0,a.hide)("join_code_submit","join_other_phone","join_resend"),(0,i.slideUp)(O.isPhoneCall()?"join_called_phone_row":"join_code_row",150),(0,a.val)("join_phone",""),(0,a.elfocus)("join_phone"),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.SCREEN_RETURN,cur.eventScreen,_.EventScreens.REGISTRATION_PHONE),O.initStats()},call(){ajax.post("join.php",{act:"call",hash:cur.hash},{progress:(0,d.curBox)().progress,onDone:(e,t)=>{(0,d.curBox)().hide(),cur.validationType=t,_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.RESEND_SMS_CODE,cur.eventScreen),O.isPhoneCall()?O.phoneDone():(0,a.elfocus)("join_code"),O.showMsg("join_submit_result",e)}})},tipShow(e,t,n,o){var i=(0,a.ge)(e),r=()=>{(0,h.showTooltip)(i,{text:t,dir:"left",slideX:15,className:"join_finish_tt"+(o?" "+o:""),shift:n,onCreate:l.removeEvent.pbind(e,"mouseout")})};vk.loaded?setTimeout(r,0):(0,l.addEvent)(window,"load",r)},tipHide(){var e=["join_phone","join_code","join_pass","join_called_phone"];e.map((t=>{var n=(0,a.ge)(e[t]);n&&n.tt&&n.tt.hide&&n.tt.hide()}))},phoneTip(e){var t=(0,a.ge)("join_phone"),n=(0,a.getSize)(t);t.readOnly||O.tipShow(t,e,[-(n[0]+10),-Math.floor(n[1]/2)],"join_phone_tt")},passTip(){var e=(0,a.ge)("join_pass"),t=(0,a.getSize)(e);return O.tipShow(e,(0,p.getLang)("join_pass_tip"),[-(t[0]+10),-Math.floor(t[1]/2)])},switchToDefSign(e,t){ajax.post("join.php",{act:"logout",hash:e,noredir:1},{onDone:()=>{(0,u.showBox)("join.php",{act:"box",from:nav.strLoc,nofb:1})},showProgress:s.lockButton.pbind(t),hideProgress:s.unlockButton.pbind(t)})},initContacts(){var e;selectsData.setCountries(cur.selData.countries),selectsData.setCities(cur.selData.country,cur.selData.cities),cur.selData.city_val=cur.selData.city_val||["",""],cur.selData.country_val=cur.selData.country_val||["",""],cur.uiCity=new CitySelect((0,a.ge)("pedit_city"),(0,a.ge)("pedit_city_row"),{progressBar:(0,a.ge)("pedit_progress"),city:cur.selData.city_val,country:cur.selData.country,maxItemsShown:e=>e>6?500:350,onChange:t=>{t!==e&&(e=t,_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.CITY,`${t}`))},dark:1,width:280}),e=(0,c.intval)(cur.uiCity.val()),cur.uiCountry=new CountrySelect((0,a.ge)("pedit_country"),(0,a.ge)("pedit_country_row"),{progressBar:(0,a.ge)("pedit_progress"),country:cur.selData.country_val,citySelect:cur.uiCity,onChange:e=>{_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.COUNTRY,`${e}`),T(_.RegistrationFieldItemNames.PHONE_COUNTRY,(function(){_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.FIRST_COUNTRY,cur.eventScreen)})),O.checkSave(e)},dark:1,width:280}),O.checkSave((0,a.ge)("pedit_country").value),O.initStats()},submitContacts(){var e={act:"check_contacts",hash:cur.saveHash,country:(0,a.ge)("pedit_country").value,city:(0,a.ge)("pedit_city").value};if(!e.country)return(0,E.joinLogProgress)(v.JoinProgressLog.SCREEN_CONTACTS,v.JoinProgressLog.STATUS_ERROR,v.JoinProgressLog.ERROR_EMPTY_CONTACTS),O.showMsg("join_submit_result",(0,p.getLang)("join_need_contacts")),!0;var t=(0,a.ge)("join_save");ajax.post("join.php",e,{onDone:()=>{R(),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.SCREEN_PROCEED,cur.eventScreen,_.EventScreens.REGISTRATION_EDUCATION),nav.go("/join?act=education")},onFail:e=>(O.showMsg("join_submit_result",e),!0),showProgress:s.lockButton.pbind(t),hideProgress:s.unlockButton.pbind(t)})},initEducation(){selectsData.setCountries(cur.selData.countries),selectsData.setCities(cur.selData.country,cur.selData.cities),cur.selData.city_val=cur.selData.city_val||["",""],cur.selData.country_val=cur.selData.country_val||["",""];var e=(0,a.ge)("edu"),t={id:0,width:280,city:cur.selData.city,city_val:cur.selData.city_val,country:cur.selData.country,country_val:cur.selData.country_val};if(cur.isSchool){var n={school0country:cur.selData.country_val[0],school0city:cur.selData.city_val[0]};e.appendChild(ProfileEditorEdu.genSchoolRow(0)),ProfileEditorEdu.initSchoolRow(t,null,(e=>{T(_.RegistrationFieldItemNames.CLASS,(function(){_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.FIRST_EDUCATION,cur.eventScreen)})),O.checkSave(e)}),(()=>{var e=ProfileEditorEdu.addSchoolParams({},{id:0},"school0");n.school0country!=e.school0country&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.COUNTRY,`${e.school0country}`||""),n.school0city!=e.school0city&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.CITY,e.school0city||""),n.school0graduation!=e.school0graduation&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.GRADUATION,e.school0graduation||""),n.school0school!=e.school0school&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.SCHOOL,e.school0school||""),n.school0start!=e.school0start&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.YEAR_FROM,e.school0start||""),n.school0finish!=e.school0finish&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.YEAR_TO,e.school0finish||""),n.school0class!=e.school0class&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.CLASS,e.school0class||""),n.school0custom_spec!=e.school0custom_spec&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.SPECIALIZATION,e.school0custom_spec||""),n=e})),O.checkSave((0,a.ge)("s_school0").value),(0,l.addEvent)((0,a.ge)("s_spec0_custom"),"keydown",(function(e){10!=e.keyCode&&13!=e.keyCode||O.submitEducation()}))}else{var o={primary_unicountry:cur.selData.country_val[0],primary_unicity:cur.selData.city_val[0]};e.appendChild(ProfileEditorEdu.genUniRow(0)),ProfileEditorEdu.initUniRow(t,null,(e=>{T(_.RegistrationFieldItemNames.EDU_FORM,(function(){_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.FIRST_EDUCATION,cur.eventScreen)})),O.checkSave(e)}),(()=>{var e=ProfileEditorEdu.addUniParams({},{id:0},"primary_uni");o.primary_unicountry!=e.primary_unicountry&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.COUNTRY,e.primary_unicountry||""),o.primary_unicity!=e.primary_unicity&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.CITY,e.primary_unicity||""),o.primary_unigraduation!=e.primary_unigraduation&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.GRADUATION,e.primary_unigraduation||""),o.primary_uniuniversity!=e.primary_uniuniversity&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.UNIVERSITY,e.primary_uniuniversity||""),o.primary_unifaculty!=e.primary_unifaculty&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.FACULTY,e.primary_unifaculty||""),o.primary_unichair!=e.primary_unichair&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.CHAIR,e.primary_unichair||""),o.primary_uniedu_form!=e.primary_uniedu_form&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.EDU_FORM,e.primary_uniedu_form||""),o.primary_uniedu_status!=e.primary_uniedu_status&&_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.EDU_STATUS,e.primary_uniedu_status||""),o=e})),O.checkSave((0,a.ge)("u_university0").value)}O.initStats()},submitEducation(){var e,t;if(cur.isSchool?(t={act:"a_save_education_school"},(t=ProfileEditorEdu.addSchoolParams(t,{id:0},"school0")).school0school||(e=(0,p.getLang)("join_need_school")),t.school0id=-1):(t={act:"a_save_education_uni"},(t=ProfileEditorEdu.addUniParams(t,{id:0},"primary_uni")).primary_uniuniversity||(e=(0,p.getLang)("join_need_uni")),t.primary_uniid=cur.uniId||-1),e)return _.registrationItemStat.logEvent(_.RegistrationItemEventTypes.INCORRECT_EDUCATION,cur.eventScreen),(0,E.joinLogProgress)(v.JoinProgressLog.SCREEN_EDUCATION,v.JoinProgressLog.STATUS_ERROR,cur.isSchool?v.JoinProgressLog.ERROR_EMPTY_SCHOOL:v.JoinProgressLog.ERROR_EMPTY_UNIVERSITY),O.showMsg("join_submit_result",e),!0;var n=(0,a.ge)("join_save");t.hash=cur.saveHash,ajax.post("al_profileEdit.php",t,{onDone:()=>{R(),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.SCREEN_PROCEED,cur.eventScreen,_.EventScreens.REGISTRATION_EMAIL),(0,E.joinLogProgress)(v.JoinProgressLog.SCREEN_EDUCATION,v.JoinProgressLog.STATUS_SUCCESS),nav.go("/join?act=email")},showProgress:s.lockButton.pbind(n),hideProgress:s.unlockButton.pbind(n)})},initEmail(){var e=(0,a.ge)("pedit_email");(0,l.addEvent)(e,"keydown change",(function(t){T(_.RegistrationFieldItemNames.EMAIL,(function(){_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.FIRST_EMAIL,cur.eventScreen)})),10===t.keyCode||13===t.keyCode?O.submitEmail():O.checkSave(e.value),_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.EMAIL,e.value)})),O.checkSave(),O.initStats()},submitEmail(){var e={email:document.querySelector("#pedit_email").value.trim(),is_new:1,hash:cur.saveHash};if(!e.email)return _.registrationItemStat.logEvent(_.RegistrationItemEventTypes.ERROR_EMPTY_EMAIL,cur.eventScreen),(0,E.joinLogProgress)(v.JoinProgressLog.SCREEN_EMAIL,v.JoinProgressLog.STATUS_ERROR,v.JoinProgressLog.ERROR_EMPTY_EMAIL),O.showMsg("join_submit_result",(0,p.getLang)("join_need_email")),!0;var t=(0,a.ge)("join_save");e.hash=cur.saveHash,ajax.post("al_settings.php?act=a_bind_mail",e,{onDone:()=>{R(),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.SCREEN_PROCEED,cur.eventScreen),(0,E.joinLogProgress)(v.JoinProgressLog.SCREEN_EMAIL,v.JoinProgressLog.STATUS_SUCCESS),location.href="/feed"},onFail:e=>{if(void 0!==e){var t=void 0!==e.message?e.message:e;O.showMsg("join_submit_result",t),"ALREADY_USED"===e.code?(0,E.joinLogProgress)(v.JoinProgressLog.SCREEN_EMAIL,v.JoinProgressLog.STATUS_ERROR,v.JoinProgressLog.ERROR_EMAIL_ALREADY_USED):(0,E.joinLogProgress)(v.JoinProgressLog.SCREEN_EMAIL,v.JoinProgressLog.STATUS_ERROR,v.JoinProgressLog.ERROR_INCORRECT_EMAIL)}return!0},showProgress:()=>(0,s.lockButton)(t),hideProgress:()=>(0,s.unlockButton)(t)})},checkSave(e){(0,s.disableButton)((0,a.ge)("join_save"),!e)},showPolicy(e){(0,u.showBox)("al_help.php",{act:e,cc_id:cur.uiPhoneCountry.val()||0,box:1})},updatePolicyLink(e){var t=(0,a.geByClass1)("checkbox","join_accept_terms_checkbox");(0,s.checkbox)(t,0);ajax.post("join.php",{act:"update_policy",cc_id:e||0},{onDone:e=>{if(e){var t=(0,a.ge)("join_accept_terms_checkbox");if(t){var n=(0,a.geByClass1)("join_accept_terms_text",t);n&&(n.innerHTML=e)}}}})},phoneOnKeyUp(){clearTimeout(O.checkPhoneTimeout);var e=O.getPhone();e&&e!==O.prevPhone&&(e.length>4?O.checkPhoneTimeout=setTimeout((function(){ajax.post("activation.php",{act:"mrg_check_phone",phone:e,rnd:O.phoneMrgInstanceId},{onDone:t=>{O.prevPhone=e,!t&&O.defaultPhoneTip||(O.destroyPhoneTip(),t&&((0,a.ge)("join_phone_prefixed")?(0,s.notaBene)("join_phone_prefixed"):(0,s.notaBene)("join_phone"),O.defaultPhoneTip=!1))}})}),500):(O.prevPhone=e,O.defaultPhoneTip||O.destroyPhoneTip()))},destroyPhoneTip(){var e=(0,a.ge)("join_phone");e&&e.tt&&e.tt.destroy()},silentAuth(){},completeProceed(){R(),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.SCREEN_PROCEED,cur.eventScreen,_.EventScreens.REGISTRATION_COUNTRY)},completeSkip(){R(),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.SCREEN_SKIP,cur.eventScreen),(0,E.joinLogProgress)(v.JoinProgressLog.SCREEN_DONE,v.JoinProgressLog.STATUS_SKIP)},educationSkip(){R(),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.SCREEN_SKIP,cur.eventScreen,_.EventScreens.REGISTRATION_EMAIL),(0,E.joinLogProgress)(v.JoinProgressLog.SCREEN_EDUCATION,v.JoinProgressLog.STATUS_SKIP)},contactsSkip(){R(),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.SCREEN_SKIP,cur.eventScreen,_.EventScreens.REGISTRATION_EDUCATION),(0,E.joinLogProgress)(v.JoinProgressLog.SCREEN_CONTACTS,v.JoinProgressLog.STATUS_SKIP)},emailSkip(){R(),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.SCREEN_SKIP,cur.eventScreen),(0,E.joinLogProgress)(v.JoinProgressLog.SCREEN_EMAIL,v.JoinProgressLog.STATUS_SKIP)},initDone(){R(),O.initStats(),(0,g.tmrTrackRegistration)()},initFbDone(){(0,g.tmrTrackRegistration)()},initFbStats(){cur.eventNextScreen?cur.eventCurrentScreen=cur.eventNextScreen:cur.eventCurrentScreen=_.EventScreens.OAUTH_FB,cur.eventNextScreen=void 0;var e=(0,a.isVisible)("join_phone_row"),t=(0,a.isVisible)("join_code_row"),n=(0,a.isVisible)("join_pass_row");e&&!t&&(cur.eventNextScreen=_.EventScreens.REGISTRATION_PHONE),n&&(cur.eventNextScreen=_.EventScreens.REGISTRATION_PASSWORD),e||t||n||(cur.eventNextScreen=_.EventScreens.REGISTRATION_COMPLETE),cur.eventNextScreen&&cur.eventCurrentScreen!==cur.eventNextScreen&&(_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.FACEBOOK_REGISTRATION,_.EventFieldValues.REGISTERED_VIA_FB),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.SCREEN_PROCEED,cur.eventCurrentScreen,cur.eventNextScreen))},validated(e,t){cur.fbSigned=!0,cur.fbValid=e,clearInterval(cur.checkInterval),e||(t||((0,a.show)("join_fb_mobile"),cur.mobileValidated||(0,a.hide)("join_pass_row")),cur.mobileValidated?(0,a.show)("join_pass_submit"):((0,a.hide)("join_pass_submit"),cur.mobileSelected||(0,a.show)("join_phone_submit")),(0,a.hide)("join_email_row")),O.initFbStats()},uploadPhoto(e){if(!e.pic_url)return!1;utilsNode.appendChild((0,a.ce)("iframe",{src:e.pic_url})),window.onUploadDone=function(e,t,n){debugLog(arguments)},window.onUploadFail=function(){debugLog(arguments)}},checkUser(){if(cur.requestChecking)return!1;cur.requestChecking=!0,ajax.post("/join",{act:"fb_check",validating:cur.validating?"1":""},{onDone:function(e,t){if(cur.requestChecking=!1,debugLog(e,t),e)if(t.failed)_.registrationItemStat&&(_.registrationItemStat.logFieldInteraction(_.RegistrationFieldItemNames.FACEBOOK_REGISTRATION,_.EventFieldValues.REGISTERED_VIA_FB),_.registrationItemStat.logEvent(_.RegistrationItemEventTypes.SCREEN_PROCEED,_.EventScreens.OAUTH_FB,_.EventScreens.FACEBOOK_REGISTRATION_FAILED,{force:!0})),(0,a.ge)("join_fb_finish").innerHTML=t.html,clearInterval(cur.checkInterval);else if(cur.validating)void 0!==t.validated&&O.validated(t.validated);else{(0,a.val)((0,a.ge)("quick_email"),t.email),cur.fbEmail=t.email,cur.joinParams.join_code=t.join_code,cur.joinParams.join_hash=t.join_hash,t.fb_id&&(cur.fbId=t.fb_id);var n=(0,a.ge)("join_fb_import_info");if((0,a.ge)("join_fb_info").innerHTML=t.html,void 0!==t.validated||t.login_to?O.validated(t.validated,t.login_to):cur.validating=!0,t.login_to)return(0,a.hide)("join_pass_row"),O.initFbStats(),O.submitPassword(!1,!0),nav.go("/login?email="+t.email+"&m=5"),!1;setStyle(n,{overflow:"hidden"}),animate(n,{height:0,opacity:0,marginTop:-10},{duration:200}),animate((0,a.ge)("join_show_result_wrap"),{opacity:1},{duration:200}),(0,i.slideDown)((0,a.ge)("join_show_result"),200),O.uploadPhoto(t),O.initFbStats()}}})},initIndexJoinForm:function(e){var t=document.querySelector(".JoinForm");(0,m.initJoinForm)(t,I({},e,{ref:"index"}))},initInviteJoinForm:function(e){var t=document.querySelector(".JoinForm");(0,m.initJoinForm)(t,I({},e,{ref:"invite"}))},initJoinBox:function(e){var t=(0,d.curBox)();t.changed=!0,t.setOptions({width:560,hideButtons:!0,bodyStyle:"padding: 0"});var n=t.bodyNode.querySelector(".JoinForm");(0,m.initJoinForm)(n,I({},e,{ref:"box"}))},initIndexJoinVKConnectButton:function(e,t){var n=document.querySelector(".JoinForm");(0,f.initJoinVKConnectButton)(n,I({},e,{unauthId:t}))},initIndexJoinVKConnectForm:function(e,t,n,o){var i=document.querySelector(".JoinForm");(0,f.initJoinVKConnectForm)(i,I({},e,{unauthId:t,phonePrefix:n,hash:o}))},initCommon:function(e){var t=e.logoutLabel,n=e.logoutHash,o=document.querySelector("#top_reg_link");o&&(clearTimeout(window.__joinTopTO),setTimeout((()=>{o.old=o.innerHTML,o.was=(0,a.isVisible)(o),o.innerHTML=t,o.onclick=e=>{if(cur.checkInterval&&clearInterval(cur.checkInterval),!1===checkEvent(e))return window.ajax.post("join.php",{act:"logout",hash:n}),cancelEvent(e)},(0,a.show)(o),cur.destroy.push((()=>{window.__joinTopTO=setTimeout((()=>{(0,a.val)(o,o.old),o.onclick=()=>{},o.was||(0,a.hide)(o)}),500)}))}),0)),(0,a.hide)("top_switch_lang","ts_wrap")}}},559367:(e,t,n)=>{n.d(t,{initJoinVKConnectButton:()=>h,initJoinVKConnectForm:()=>_});var o=n(988882),i=n(214547),r=n(70488),a=n(386409),s=n(124041),c=n(100416),l=n(41650),u=i.EventScreens.START;function d(e){var t=window.vk.apiConfigDomains,n=t.loginDomain,i=t.connectDomain;o.Config.init({appId:7913379,loginDomain:n,connectDomain:i,appSettings:{external_device_id:e,vkc_auth_action:"registration",promo:"registration"}})}function p(e){e&&(u=i.EventScreens.START_PROCEED_AS),window.cur.eventScreen=u,r.registrationItemStat.logEvent(i.RegistrationItemEventTypes.SCREEN_PROCEED,i.EventScreens.NOWHERE,u,{force:!0})}function h(e,t){var n=t.proceedAs;d(t.unauthId),p(n);var i=e.querySelector(".JoinForm__connectButton");if(i){i.addEventListener("click",(function(e){var t;e.preventDefault(),t=location.protocol+"//"+location.host+"/join",o.Connect.redirectAuth({url:t})}))}}function _(e,t){var n=t.proceedAs,h=t.unauthId,_=t.phonePrefix,g=t.hash,m=t.fbApp,f=t.fbState,v=t.fbLocale;d(h),p(n);var E=e.querySelector('.JoinForm__textInput[name="phone"]'),S=e.querySelector(".JoinForm__connectButton"),y=e.querySelector(".JoinForm__connectError"),I=e.querySelector(".JoinForm__form"),T=e.querySelector(".JoinForm__facebookLogin"),R=e.querySelector(".JoinForm__facebookLogin .FacebookLogin__button"),A=!1;if(E&&S&&y&&I){var O=function(e){(0,a.notaBene)(E),y&&e&&(y.innerHTML=e),r.registrationItemStat.logEvent(i.RegistrationItemEventTypes.INCORRECT_PHONE_NUMBER,u,void 0,{force:!0})},C=function(){s.FlatButton.isLocked(S)||(!function(e){var t=String(e).replace(/[^0-9]/g,"").length;return t>=10&&t<=13}(E.value.trim().replace(" ",""))?O((0,l.getLang)("index_error_bad_phone")):function(e,t,n){var i=e.hash;window.ajax.post("join.php?act=connect",e,{onDone:function(e,r){if("error"===e)return O((0,l.getLang)("index_error_bad_phone")),void(0,a.notaBene)(n);s.FlatButton.lock(t);var c={url:location.protocol+"//"+location.host+"/join",action:{name:"registration_with_phone",token:r,params:{csrf_hash:i}}};o.Connect.redirectAuth(c)},showProgress:function(){return s.FlatButton.lock(t)},hideProgress:function(){return s.FlatButton.unlock(t)}})}({phone:E.value.trim(),hash:g},S,E))};if((0,c.placeholderInit)(E),E.value=_,E.addEventListener("keyup",(function(e){"Enter"!==e.key&&(y&&y.innerHTML&&(y.innerHTML=""),A||(r.registrationItemStat.logEvent(i.RegistrationItemEventTypes.START_REG_TAP,u,void 0,{force:!0}),A=!0))})),I.addEventListener("submit",(function(e){e.preventDefault(),C()})),S.addEventListener("click",(function(e){e.preventDefault(),C()})),m){var P=window.cur;P.fbApp=m,P.fbState=f,P.fbLocale=v,window.Index.fbCheck(m,"",T)}null==R||R.addEventListener("click",(function(e){e.preventDefault(),window.Index.fbJoin("",R)}))}}},47647:(e,t,n)=>{n.d(t,{JoinProgressLog:()=>o});var o={SCREEN_CONTACTS:"contacts",SCREEN_FINISH:"finish",SCREEN_DONE:"done",SCREEN_EDUCATION:"education",SCREEN_EMAIL:"email",STATUS_ERROR:"error",STATUS_SUCCESS:"success",STATUS_SKIP:"skip",ERROR_PASSWORD:"password error",ERROR_EMPTY_CONTACTS:"empty contacts",ERROR_EMPTY_SCHOOL:"empty school",ERROR_EMPTY_UNIVERSITY:"empty university",ERROR_EMPTY_EMAIL:"empty email",ERROR_INCORRECT_EMAIL:"incorrect email",ERROR_EMAIL_ALREADY_USED:"phone already used"}},517957:(e,t,n)=>{n.d(t,{joinLogProgress:()=>i});var o=n(479957);function i(e,t,n){(0,o.statlogsValueEvent)("join_progress",e,t,n)}}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={id:e,loaded:!1,exports:{}};return o[e].call(n.exports,n,n.exports,r),n.loaded=!0,n.exports}r.m=o,e=[],r.O=(t,n,o,i)=>{if(!n){var a=1/0;for(u=0;u<e.length;u++){for(var[n,o,i]=e[u],s=!0,c=0;c<n.length;c++)(!1&i||a>=i)&&Object.keys(r.O).every((e=>r.O[e](n[c])))?n.splice(c--,1):(s=!1,i<a&&(a=i));if(s){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[n,o,i]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var i=Object.create(null);r.r(i);var a={};t=t||[null,n({}),n([]),n(n)];for(var s=2&o&&e;"object"==typeof s&&!~t.indexOf(s);s=n(s))Object.getOwnPropertyNames(s).forEach((t=>a[t]=()=>e[t]));return a.default=()=>e,r.d(i,a),i},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.e=()=>Promise.resolve(),r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={1092:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,[a,s,c]=n,l=0;for(o in s)r.o(s,o)&&(r.m[o]=s[o]);if(c)var u=c(r);for(t&&t(n);l<a.length;l++)i=a[l],r.o(e,i)&&e[i]&&e[i][0](),e[a[l]]=0;return r.O(u)},n=self.webpackChunkvk=self.webpackChunkvk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=r.O(void 0,[68592],(()=>r(601939)));a=r.O(a)})();